#!/bin/bash

[[ "$PAKLIB_ROOT" == "" ]] && export PAKLIB_ROOT=$(pwd -P)/.spm/paklib

function untar_payload {
	match=$(grep --text --line-number '^PAYLOAD:$' $0 | cut -d ':' -f 1)
	payload_start=$((match + 1))
	tail -n +$payload_start $0 | base64 -d | tar -xjf -
}

if [[ ! -d "${PAKLIB_ROOT}" ]]; then
	untar_payload
fi
export LUA_PATH=${PAKLIB_ROOT}/?.lua
lua ${PAKLIB_ROOT}/main.lua $@
exit $?
PAYLOAD:
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
