#!/bin/bash

[[ "$PAKLIB_ROOT" == "" ]] && export PAKLIB_ROOT=$(pwd -P)/.spm/paklib

function untar_payload {
	match=$(grep --text --line-number '^PAYLOAD:$' $0 | cut -d ':' -f 1)
	payload_start=$((match + 1))
	tail -n +$payload_start $0 | base64 -d | tar -xjf -
}

if [[ ! -d "${PAKLIB_ROOT}" ]]; then
	untar_payload
fi
export LUA_PATH=${PAKLIB_ROOT}/?.lua
lua ${PAKLIB_ROOT}/main.lua $@
exit $?
PAYLOAD:
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
