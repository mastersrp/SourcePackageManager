#!/bin/bash

[[ "$PAKLIB_ROOT" == "" ]] && export PAKLIB_ROOT=$(pwd -P)/.spm/paklib

for arg in "$@"; do
	[[ "$arg" == "--force-unpack" ]] && force_unpack = true
done

function untar_payload {
	match=$(grep --text --line-number '^PAYLOAD:$' $0 | cut -d ':' -f 1)
	payload_start=$((match + 1))
	tail -n +$payload_start $0 | base64 -d | tar -xjf -
}

if [[ ! -d "${PAKLIB_ROOT}" || "$force_unpack" == "true" ]]; then
	untar_payload
fi
export LUA_PATH=${PAKLIB_ROOT}/?.lua
install -d build/
lua ${PAKLIB_ROOT}/main.lua $@
exit $?
PAYLOAD:
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
