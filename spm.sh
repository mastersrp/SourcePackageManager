#!/bin/bash

[[ "$PAKLIB_ROOT" == "" ]] && export PAKLIB_ROOT=$(pwd -P)/.spm/paklib

function untar_payload {
	match=$(grep --text --line-number '^PAYLOAD:$' $0 | cut -d ':' -f 1)
	payload_start=$((match + 1))
	tail -n +$payload_start $0 | base64 -d | tar -xjf -
}

if [[ ! -d "${PAKLIB_ROOT}" ]]; then
	untar_payload
fi
export LUA_PATH=${PAKLIB_ROOT}/?.lua
install -d build/
lua ${PAKLIB_ROOT}/main.lua $@
exit $?
PAYLOAD:
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
