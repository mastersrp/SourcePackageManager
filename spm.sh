#!/bin/bash

[[ "$PAKLIB_ROOT" == "" ]] && export PAKLIB_ROOT=$(pwd -P)/.spm/paklib

function untar_payload {
	match=$(grep --text --line-number '^PAYLOAD:$' $0 | cut -d ':' -f 1)
	payload_start=$((match + 1))
	tail -n +$payload_start $0 | base64 -d | tar -xjf -
}

if [[ ! -d "${PAKLIB_ROOT}" ]]; then
	untar_payload
fi
export LUA_PATH=${PAKLIB_ROOT}/?.lua
install -d build/
lua ${PAKLIB_ROOT}/main.lua $@
exit $?
PAYLOAD:
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
